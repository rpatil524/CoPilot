CREATE DISTRIBUTED QUERY StreamDocIds(INT current_batch, INT ttl_batches) {
    ListAccum<STRING> @@doc_ids;
    Docs = {Document.*};

    Docs = SELECT d FROM Docs:d
           WHERE vertex_to_int(d) % ttl_batches == current_batch
             AND d.epoch_processed == 0
             AND d.epoch_processing == 0 
           ACCUM @@doc_ids += d.id
           POST-ACCUM d.epoch_processing = datetime_to_epoch(now());
    
    PRINT @@doc_ids;
}
